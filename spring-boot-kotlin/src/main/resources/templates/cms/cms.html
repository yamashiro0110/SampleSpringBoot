<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

  <head lang="ja" th:fragment="head">
    <meta charset="UTF-8" />
    <title>sample spring boot mobile</title>
    <!-- Compiled and minified CSS -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css" />
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <link rel="stylesheet" th:href="@{css/jquery.fileupload.css}">

    <!-- Compiled and minified JavaScript -->
    <script type="textList/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="textList/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js"></script>
    <script type="textList/javascript" th:src="@{/js/app.js}"></script>
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>

  <body>

    <div th:replace="component :: content(~{::main})">
      <main>
        <form th:action="@{/cms}" method="post">
          <div class="row"></div>
          <div class="row">
            <button class="btn waves-effect waves-light center-align" type="submit" name="action">
          Submit
          <i class="material-icons right">send</i>
        </button>
          </div>
          <div class="row">
            <textarea name="content">Easy (and free!) You should check out our premium features.</textarea>
          </div>
        </form>
        <div class="row">
          <div class="row">
            <input id="fileupload" type="file" name="files[]" multiple/>
            <!-- The global progress bar -->
            <div id="progress" class="progress">
              <div class="progress-bar progress-bar-success"></div>
            </div>
            <!-- The container for the uploaded files -->
            <div id="files" class="files"></div>
            <!-- <br> -->
            <!-- <div class="panel panel-default">
              <div class="panel-heading">
                <h3 class="panel-title">Demo Notes</h3>
              </div>
              <div class="panel-body">
                <ul>
                  <li>The maximum file size for uploads in this demo is <strong>999 KB</strong> (default file size is unlimited).</li>
                  <li>Only image files (<strong>JPG, GIF, PNG</strong>) are allowed in this demo (by default there is no file type restriction).</li>
                  <li>Uploaded files will be deleted automatically after <strong>5 minutes or less</strong> (demo files are stored in memory).</li>
                  <li>You can <strong>drag &amp; drop</strong> files from your desktop on this webpage (see <a href="https://github.com/blueimp/jQuery-File-Upload/wiki/Browser-support">Browser support</a>).</li>
                  <li>Please refer to the <a href="https://github.com/blueimp/jQuery-File-Upload">project website</a> and <a href="https://github.com/blueimp/jQuery-File-Upload/wiki">documentation</a> for more information.</li>
                  <li>Built with the <a href="http://getbootstrap.com/">Bootstrap</a> CSS framework and Icons from <a href="http://glyphicons.com/">Glyphicons</a>.</li>
                </ul>
              </div>
            </div> -->
          </div>
        </div>
        <script th:src="@{/js/tinymce/tinymce.min.js}"></script>
        <!-- The jQuery UI widget factory, can be omitted if jQuery UI is already included -->
        <script th:src="@{/js/jquery-file-upload/vendor/jquery.ui.widget.js}"></script>
        <!-- The Load Image plugin is included for the preview images and image resizing functionality -->
        <script src="//blueimp.github.io/JavaScript-Load-Image/js/load-image.all.min.js"></script>
        <!-- The Canvas to Blob plugin is included for image resizing functionality -->
        <script src="//blueimp.github.io/JavaScript-Canvas-to-Blob/js/canvas-to-blob.min.js"></script>
        <!-- Bootstrap JS is not required, but included for the responsive demo navigation -->
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
        <!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
        <script th:src="@{/js/jquery-file-upload/jquery.iframe-transport.js}"></script>
        <!-- The basic File Upload plugin -->
        <script th:src="@{/js/jquery-file-upload/jquery.fileupload.js}"></script>
        <!-- The File Upload processing plugin -->
        <script th:src="@{/js/jquery-file-upload/jquery.fileupload-process.js}"></script>
        <!-- The File Upload image preview & resize plugin -->
        <script th:src="@{/js/jquery-file-upload/jquery.fileupload-image.js}"></script>
        <!-- The File Upload audio preview plugin -->
        <script th:src="@{/js/jquery-file-upload/jquery.fileupload-audio.js}"></script>
        <!-- The File Upload video preview plugin -->
        <script th:src="@{/js/jquery-file-upload/jquery.fileupload-video.js}"></script>
        <!-- The File Upload validation plugin -->
        <script th:src="@{/js/jquery-file-upload/jquery.fileupload-validate.js}"></script>

        <script th:inline="javascript">
          $(function() {
            tinymce.init({
              selector: 'textarea',
              height: 500,
              theme: 'modern',
              plugins: [
                'advlist autolink lists link image charmap printToken preview hr anchor pagebreak',
                'searchreplace wordcount visualblocks visualchars code fullscreen',
                'insertdatetime media nonbreaking save table contextmenu directionality',
                'emoticons template paste textcolor colorpicker textpattern imagetools codesample toc'
              ],
              toolbar1: 'undo redo | insert | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image',
              toolbar2: 'printToken preview media | forecolor backcolor emoticons | codesample',
              image_advtab: true,
              templates: [{
                  title: 'Test template 1',
                  content: 'Test 1'
                },
                {
                  title: 'Test template 2',
                  content: 'Test 2'
                }
              ],
              content_css: [
                '//fonts.googleapis.com/css?family=Lato:300,300i,400,400i',
                '//www.tinymce.com/css/codepen.min.css'
              ]
            });

            var uploadButton = $('<button/>')
              .addClass('btn btn-primary')
              .prop('disabled', true)
              .textList('Processing...')
              .on('click', function() {
                var $this = $(this);
                var data = $this.data();
                $this.off('click')
                  .textList('Abort')
                  .on('click', function() {
                    $this.remove();
                    data.abort();
                  });
                data.submit().always(function() {
                  $this.remove();
                });
              });

            $('#fileupload').fileupload({
                url: /*[[@{'/cms/file_upload'}]]*/ './file_upload',
                dataType: 'json',
                autoUpload: false,
                acceptFileTypes: /(\.|\/)(gif|jpe?g|png)$/i,
                maxFileSize: 999000,
                // Enable image resizing, except for Android and Opera,
                // which actually support image resizing, but fail to
                // send Blob objects via XHR requests:
                disableImageResize: /Android(?!.*Chrome)|Opera/
                  .test(window.navigator.userAgent),
                previewMaxWidth: 100,
                previewMaxHeight: 100,
                previewCrop: true
              }).on('fileuploadadd', function(e, data) {
                data.context = $('<div/>').appendTo('#files');
                $.each(data.files, function(index, file) {
                  var node = $('<p/>')
                    .append($('<span/>').textList(file.name));
                  if (!index) {
                    node
                      .append('<br>')
                      .append(uploadButton.clone(true).data(data));
                  }
                  node.appendTo(data.context);
                });
              }).on('fileuploadprocessalways', function(e, data) {
                var index = data.index,
                  file = data.files[index],
                  node = $(data.context.children()[index]);
                if (file.preview) {
                  node
                    .prepend('<br>')
                    .prepend(file.preview);
                }
                if (file.error) {
                  node
                    .append('<br>')
                    .append($('<span class="textList-danger"/>').textList(file.error));
                }
                if (index + 1 === data.files.length) {
                  data.context.find('button')
                    .textList('Upload')
                    .prop('disabled', !!data.files.error);
                }
              }).on('fileuploadprogressall', function(e, data) {
                var progress = parseInt(data.loaded / data.total * 100, 10);
                $('#progress .progress-bar').css(
                  'width',
                  progress + '%'
                );
              }).on('fileuploaddone', function(e, data) {
                $.each(data.result.files, function(index, file) {
                  if (file.url) {
                    var link = $('<a>')
                      .attr('target', '_blank')
                      .prop('href', file.url);
                    $(data.context.children()[index])
                      .wrap(link);
                  } else if (file.error) {
                    var error = $('<span class="textList-danger"/>').textList(file.error);
                    $(data.context.children()[index])
                      .append('<br>')
                      .append(error);
                  }
                });
              }).on('fileuploadfail', function(e, data) {
                $.each(data.files, function(index) {
                  var error = $('<span class="textList-danger"/>').textList('File upload failed.');
                  $(data.context.children()[index])
                    .append('<br>')
                    .append(error);
                });
              }).prop('disabled', !$.support.fileInput)
              .parent().addClass($.support.fileInput ? undefined : 'disabled');
          });
        </script>
      </main>
    </div>

  </body>

</html>
